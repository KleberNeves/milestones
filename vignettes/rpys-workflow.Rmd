---
title: "Workflow to identify milestones through RPYS"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{rpys-workflow}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(milestones)
```

This vignette shows how to run the main path analysis for a dataset containing bibliographic and citation data.

The first step is to search for the terms on Web of Science. If you are conducting your own search, just export it as indicated in [this vignette](!...) from package *bibliometrix* (which is used under the hood to read the data). An example of such data is available in this package, so you can just import it as indicated below. This data corresponds for a search of "captopril + hypertension".

```{r}
wos_records = system.file("extdata", "optogenetics.txt", package = "milestones", mustWork = T)

M = read_biblio_data(wos_records)
```

Once the data is imported, the next step is to run the RPYS algorithm to obtain the milestones. This has a few steps, which can be configured through the arguments to the function.

First, it runs the RPYS proper - i.e. it build the histogram of years of cited references. It then identifies the peak years through a Tukey HSD test. You can set the significance level to regulate the number of peak years identified.

Then, for each peak year, it finds the top 1% most cited papers that year. These are returned as milestones. You can change this percentage to include more papers.

```{r}
RPYS_MS = identify_rpys_milestones(M)
```

If it runs successfully, to save the list of milestones, use:

```{r}
save_papers_rpys(RPYS_MS, filename = "rpys_papers.tsv")
```

Alternatively, the save_papers function accepts a list of results to save in a single list of papers. Example:

```{r}
save_papers_rpys(list(RPYS_MS1, RPYS_MS2), filename = "rpys1+2_papers.tsv")
```

You can directly access the list of papers through

```{r}
RPYS_MS$documents
```

Besides the list of milestones, the result also contains the RPYS graph.
```{r}
RPYS_MS$rpys
```
